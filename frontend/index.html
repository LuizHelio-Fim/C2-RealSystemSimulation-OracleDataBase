<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Estudantes</title>
    <link rel="stylesheet" href="styles/globals.css">
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-content">
            <div class="splash-logo">📚</div>
            <h1>Sistema de Gestão de Estudantes</h1>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="totalStudents">0</span>
                    <span class="stat-label">Alunos</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalCourses">0</span>
                    <span class="stat-label">Cursos</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalProfessors">0</span>
                    <span class="stat-label">Professores</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalSubjects">0</span>
                    <span class="stat-label">Matérias</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalOffers">0</span>
                    <span class="stat-label">Ofertas</span>
                </div>
                <!--
                <div class="stat-card">
                    <span class="stat-number" id="totalEnrollments">0</span>
                    <span class="stat-label">Matrículas</span>
                </div>
                -->
            </div>

            <div class="credits">
                <h3>Criado por:</h3>
                <div class="credits-list">
                    <span class="credit-tag">Bernardo Lodi</span>
                    <span class="credit-tag">João Guilherme</span>
                    <span class="credit-tag">Luanna Hevellyn</span>
                    <span class="credit-tag">Luiz Fim</span>
                    <span class="credit-tag">Pedro Sousa</span>
                    <span class="credit-tag">Thomas Veiga</span>
                </div>
                <p>
                    <strong>Disciplina:</strong> Banco de Dados 2025/2<br>
                    <strong>Professor:</strong> Howard Roatti
                </p>
            </div>

            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div class="app-container" id="appContainer">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">📚 SGE</div>
                <p style="color: var(--color-text-secondary); font-size: 0.875rem; margin-top: 0.5rem;">
                    Sistema de Gestão de Estudantes
                </p>
            </div>
            
            <nav class="sidebar-nav">
                <a class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">📊</span>
                    <span>Dashboard</span>
                </a>
                <a class="nav-item" data-view="students">
                    <span class="nav-icon">👨‍🎓</span>
                    <span>Alunos</span>
                </a>
                <a class="nav-item" data-view="courses">
                    <span class="nav-icon">📚</span>
                    <span>Cursos</span>
                </a>
                <a class="nav-item" data-view="professors">
                    <span class="nav-icon">👨‍🏫</span>
                    <span>Professores</span>
                </a>
                <a class="nav-item" data-view="subjects">
                    <span class="nav-icon">📖</span>
                    <span>Matérias</span>
                </a>
                <a class="nav-item" data-view="offers">
                    <span class="nav-icon">🎓</span>
                    <span>Ofertas</span>
                </a>
                <!----
                <a class="nav-item" data-view="enrollments">
                    <span class="nav-icon">✅</span>
                    <span>Matrículas</span>
                </a>
                -->
                
                <!-- Divisor Visual -->
                <div class="nav-divider">
                    <span>Relatórios</span>
                </div>
                
                <a class="nav-item" data-view="courseStatistics">
                    <span class="nav-icon">📊</span>
                    <span>Estatísticas por Curso</span>
                </a>
                <a class="nav-item" data-view="offersComplete">
                    <span class="nav-icon">�</span>
                    <span>Relatório de Ofertas</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view active">
                <div class="header">
                    <h1 class="header-title">Dashboard</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="refreshAllData()">
                            🔄 Atualizar
                        </button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon blue">👨‍🎓</div>
                            <div>
                                <div class="card-title">Alunos</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashStudents">0</div>
                        <div class="card-description">Total de alunos cadastrados</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon orange">📚</div>
                            <div>
                                <div class="card-title">Cursos</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashCourses">0</div>
                        <div class="card-description">Cursos disponíveis</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon blue">👨‍🏫</div>
                            <div>
                                <div class="card-title">Professores</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashProfessors">0</div>
                        <div class="card-description">Professores cadastrados</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon orange">📖</div>
                            <div>
                                <div class="card-title">Matérias</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashSubjects">0</div>
                        <div class="card-description">Matérias cadastradas</div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon blue">🎓</div>
                            <div>
                                <div class="card-title">Ofertas</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashOffers">0</div>
                        <div class="card-description">Ofertas semestrais</div>
                    </div>
                    <!--
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon blue">✅</div>
                            <div>
                                <div class="card-title">Matrículas</div>
                            </div>
                        </div>
                        <div class="card-value" id="dashEnrollments">0</div>
                        <div class="card-description">Matrículas ativas</div>
                    </div>
                    -->
                </div>
            </div>

            <!-- Students View -->
            <div id="studentsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Alunos</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addStudent()">
                            ➕ Adicionar Aluno
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Lista de Alunos</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar aluno..." onkeyup="filterTable('studentsTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="studentsTable">
                            <thead>
                                <tr>
                                    <th>Matrícula</th>
                                    <th>CPF</th>
                                    <th>Nome</th>
                                    <th>Data de Nascimento</th>
                                    <th>Telefone</th>
                                    <th>Email</th>
                                    <th>Período</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <tr><td colspan="8" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Courses View -->
            <div id="coursesView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Cursos</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addCourse()">
                            ➕ Adicionar Curso
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Lista de Cursos</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar curso..." onkeyup="filterTable('coursesTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="coursesTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Carga Horária</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="coursesTableBody">
                                <tr><td colspan="5" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Professors View -->
            <div id="professorsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Professores</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addProfessor()">
                            ➕ Adicionar Professor
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Lista de Professores</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar professor..." onkeyup="filterTable('professorsTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="professorsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>CPF</th>
                                    <th>Nome</th>
                                    <th>Data de Nascimento</th>
                                    <th>Telefone</th>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="professorsTableBody">
                                <tr><td colspan="8" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Subjects View -->
            <div id="subjectsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Matérias</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addSubject()">
                            ➕ Adicionar Matéria
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Lista de Matérias</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar matéria..." onkeyup="filterTable('subjectsTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="subjectsTable">
                            <thead>
                                <tr>
                                    <th>ID Matéria</th>
                                    <th>ID Curso</th>
                                    <th>Periodo</th>
                                    <th>Nome</th>
                                    <th>Carga Horária</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="subjectsTableBody">
                                <tr><td colspan="5" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Offers View -->
            <div id="offersView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Ofertas</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addOffer()">
                            ➕ Adicionar Oferta
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Lista de Ofertas</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar oferta..." onkeyup="filterTable('offersTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="offersTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Ano</th>
                                    <th>Semestre</th>
                                    <th>ID Professor</th>
                                    <th>ID Matéria</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="offersTableBody">
                                <tr><td colspan="6" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Enrollments View -->
            <div id="enrollmentsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Matrículas (Auto-Populada)</h1>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="refreshEnrollments()">
                            🔄 Atualizar Dados
                        </button>
                        <span class="info-text">📋 Dados calculados automaticamente</span>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Grade Aluno (Somente Leitura)</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar matrícula..." onkeyup="filterTable('enrollmentsTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="enrollmentsTable">
                            <thead>
                                <tr>
                                    <th>Matrícula</th>
                                    <th>ID Oferta</th>
                                    <th>Status</th>
                                    <th>Aluno</th>
                                    <th>Matéria</th>
                                </tr>
                            </thead>
                            <tbody id="enrollmentsTableBody">
                                <tr><td colspan="5" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Grades View -->
            <div id="gradesView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">Notas</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="addGrade()">
                            ➕ Lançar Nota
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Avaliação Aluno</h2>
                        <div class="search-box">
                            <span>🔍</span>
                            <input type="text" placeholder="Buscar nota..." onkeyup="filterTable('gradesTable', this.value)">
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table id="gradesTable">
                            <thead>
                                <tr>
                                    <th>ID Avaliação</th>
                                    <th>ID Aluno</th>
                                    <th>Nota</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="gradesTableBody">
                                <tr><td colspan="4" style="text-align: center; padding: 2rem;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports View -->
            <div id="reportsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">📊 Relatórios do Sistema</h1>
                </div>

                <!-- Seletor de Relatórios -->
                <div class="report-selector" style="margin-bottom: 2rem;">
                    <button class="btn btn-primary" onclick="loadCourseStatisticsReport()" style="margin-right: 1rem;">
                        📈 Estatísticas por Curso
                    </button>
                    <button class="btn btn-secondary" onclick="loadOffersCompleteReport()">
                        � Relatório de Ofertas Completas
                    </button>
                </div>

                <!-- Conteúdo dos Relatórios -->
                <div id="reportContent">
                    <div class="info-message">
                        <p>Selecione um relatório acima para visualizar os dados.</p>
                    </div>
                </div>
            </div>

            <!-- Course Statistics View -->
            <div id="courseStatisticsView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">📊 Estatísticas por Curso</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="loadCourseStatisticsReport()">
                            🔄 Atualizar
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Relatório de Estatísticas</h2>
                    </div>
                    <div id="courseStatisticsContent">
                        <div class="loading-message">
                            <p>Carregando estatísticas...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Offers Complete View -->
            <div id="offersCompleteView" class="view" style="display: none;">
                <div class="header">
                    <h1 class="header-title">📋 Relatório de Ofertas</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="loadOffersCompleteReport()">
                            🔄 Atualizar
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h2 class="table-title">Relatório Completo de Ofertas</h2>
                    </div>
                    <div id="offersCompleteContent">
                        <div class="loading-message">
                            <p>Carregando relatório de ofertas...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Dynamic Modal Container -->
    <div id="modalContainer"></div>

    <!-- Scripts de integração com backend -->
    <script src="scripts/api-service.js?v=1.1"></script>
    <script src="scripts/crud-operations.js?v=1.1"></script>
    
    <!-- Script principal da aplicação -->
    <script src="scripts/app.js?v=1.1"></script>
    
    <!-- Scripts de relatórios (dependem do app.js) -->
    <script src="scripts/reports.js?v=1.1"></script>
    
    <!-- Scripts de teste e diagnóstico -->
    <script src="scripts/test-debug.js?v=1.1"></script>
</body>
</html>
